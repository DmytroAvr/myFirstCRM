{% extends "oids/base.html" %}
{% load static %}

{% block title %}Головна панель ОІД{% endblock %}

{% block content %}
<div class="header">
    <h1>Панель керування Об'єктами Інформаційної Діяльності</h1>
    <div class="nav-buttons">
        {# Переконайся, що ці URL-и правильно названі в oids/urls.py #}
        <a href="#">Додати заявку</a>
        <a href="#">Запланувати відрядження</a>
        <a href="#">Додати опрацювання документів</a>
    </div>
</div>

<div class="dashboard-columns">
    {# Стовпчик 1: Військові частини #}
        <div class="column">
        <h3>Військові частини</h3>
        <select name="unit_filter" id="id_unit_filter" class="select2" style="width: 100%;"
        data-ajax-url="{% url 'oids:ajax_load_oids_categorized' %}" 
        data-placeholder="Оберіть ВЧ для фільтрації ОІД..."> {# Я додав data-placeholder тут #}
    <option value=""></option> {# Порожня опція для плейсхолдера Select2 #}
    {% for unit_obj in all_units %}
        <option value="{{ unit_obj.id }}" {% if unit_obj.id|stringformat:"s" == request.GET.unit %}selected{% endif %}>
            {{ unit_obj.code }} - {{ unit_obj.name|default:unit_obj.city }} ({{ unit_obj.territorial_management.name|default:"ТУ не вказано" }})
        </option>
    {% endfor %}
</select>
    </div>

    {# Стовпчик 2: ОІД - тепер заповнюється через AJAX #}
    <div class="column column-oids">
        <h3>
            Об'єкти інформаційної діяльності 
            <span id="selectedUnitForOidDisplay">
                {% if selected_unit_object %}
                    (для ВЧ: {{ selected_unit_object.code }} - {{ selected_unit_object.name|default:selected_unit_object.city }})
                {% else %}
                    (Оберіть ВЧ для відображення ОІД)
                {% endif %}
            </span>
        </h3>

        <div id="loadingOidsIndicator" style="display: none; color: #007bff; font-style: italic;">Завантаження ОІД...</div>

        <div id="oidsCreatingSection" class="oid-list-section">
            <h4>ОІД, що створюються</h4>
            <ul id="oidsCreatingList">
                <li>Оберіть ВЧ для завантаження списку.</li>
            </ul>
        </div>
        <hr>
        <div id="oidsActiveSection" class="oid-list-section">
            <h4>Діючі ОІД</h4>
            <ul id="oidsActiveList">
                <li>Оберіть ВЧ для завантаження списку.</li>
            </ul>
        </div>
        <hr>
        <div id="oidsCancelledSection" class="oid-list-section">
            <h4>Скасовані/Припинені ОІД</h4>
            <ul id="oidsCancelledList">
                <li>Оберіть ВЧ для завантаження списку.</li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}

{% block page_specific_js %}
{# Цей скрипт вже є у filtering_dynamic.js (updateOidListsOnDashboard) 
   і викликається звідти. Переконайся, що він там є.
   Якщо ти його виніс окремо, то підключи тут або в base.html.
#}

    // function updateOidLists(data) { ... } // Ця функція має бути доступна
    // $(document).ready(function() { ... }); // Обробник зміни #id_unit_filter
                                             // тепер є частиною filtering_dynamic.js
<script>

</script>

{% endblock %}