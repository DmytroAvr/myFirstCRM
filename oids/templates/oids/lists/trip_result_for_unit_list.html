{% extends "oids/base.html" %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container-fluid">
    <h2 class="mb-4">{{ page_title }}</h2>
    {# <a href="URL_ДЛЯ_ДОДАВАННЯ_РЕЗУЛЬТАТУ" class="btn btn-primary mb-3">Додати Результат Відрядження</a> #}

    {% if object_list %}
        <table class="table table-striped table-bordered table-hover">
            <thead class="thead-dark">
                <tr>
                    <th>Дата відправки до ВЧ</th>
                    <th>Пов'язане відрядження</th>
                    <th>Військові частини призначення</th>
                    <th>ОІДи</th>
                    <!-- <th>Документи (кількість)</th>                     -->
                    <th>Примітки</th>
                    {# <th>Дії</th> #}
                </tr>
            </thead>
            <tbody>
                {% for result in object_list %}
                    <tr>
                        <td>вих.№ {{ result.outgoing_letter_number }} від {{ result.outgoing_letter_date|date:"d.m.Y" }}</td>
                        <td>
                            {% if result.trip %}
                                Відрядження: {{ result.trip.start_date|date:"d.m.Y" }} - {{ result.trip.end_date|date:"d.m.Y" }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>
                            <ul>
                            {% for unit in result.units.all %}
                                <li>{{ unit.code }} - {{ unit.name|default:unit.city }}</li>
                            {% empty %}
                                <li>-</li>
                            {% endfor %}
                            </ul>
                        </td>
                        <td>
                            <ul>
                            {% for oid_item in result.oids.all %} {# Змінив oid на oid_item #}
                                <li><a href="{% url 'oids:oid_detail_view_name' oid_item.id %}">{{ oid_item.cipher }}</a> (ВЧ: {{ oid_item.unit.code }})</li>
                            {% empty %}
                                <li>-</li>
                            {% endfor %}
                            </ul>
                        </td>
                        <!-- <td>{{ result.documents.count }}</td> -->
                       
                        <td>{{ result.note|truncatewords:10|default:"-" }}</td>
                        {# <td><a href="#" class="btn btn-sm btn-info">Деталі</a></td> #}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
        {% include "../includes/pagination.html" %}
    {% else %}
        <p>Результати відряджень не знайдено.</p>
    {% endif %}
</div>
{% endblock %}