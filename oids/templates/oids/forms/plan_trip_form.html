{% extends "oids/base.html" %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="container">
    <h2 class="mb-4">{{ page_title }}</h2>
    <form method="post" novalidate>
        {% csrf_token %}
        
        {{ form.media }} {# Для віджетів дат, якщо використовуються JS календарі #}

        {% for field in form %}
            <div class="form-group mb-3">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field }}
                {% if field.help_text %}
                    <small class="form-text text-muted">{{ field.help_text }}</small>
                {% endif %}
                {% for error in field.errors %}
                    <div class="alert alert-danger mt-1 p-1" role="alert">{{ error }}</div>
                {% endfor %}
            </div>
        {% endfor %}
        
        {% if form.non_field_errors %}
            <div class="alert alert-danger" role="alert">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}
        
        <button type="submit" class="btn btn-primary">Зберегти відрядження</button>
        <a href="{% url 'oids:main_dashboard' %}" class="btn btn-secondary">Скасувати</a>
    </form>
</div>
{% endblock %}

{% block page_specific_js %}
<script>
$(document).ready(function() {
    // Ініціалізація Select2 для полів цієї форми, якщо вони мають клас .select2
    // initSelect2Fields($('#tripForm')); // Припускаючи, що форма має id="tripForm"
    // Або якщо initSelect2Fields вже викликається глобально для всіх .select2, то це не потрібно.

    // Тут можна додати JS для динамічного фільтрування OID на основі обраних Unit,
    // використовуючи filtering_dynamic.js та data-атрибути на полях форми.
    // Наприклад, для #id_trip_units_form -> #id_trip_oids_form
    // Потрібно буде додати відповідну конфігурацію в initializeDynamicFilters
    // та data-ajax-url на #id_trip_units_form.
});
</script>
{% endblock %}