
{% load static %}

{% block content %}
<h2>Список відряджень</h2>

<form method="get" class="mb-3">
  <input type="text" name="q" placeholder="Пошук..." value="{{ request.GET.q }}" class="form-control" />
</form>

<table class="table table-striped table-bordered">
  <thead class="thead-dark">
    <tr>
      <th>Дата початку</th>
      <th>Дата завершення</th>
      <th>Військові частини</th>
      <th>ОІД</th>
      <th>Заявка</th>
      <th>Відряджаються</th>
      <th>Примітка</th>
    </tr>
  </thead>
  <tbody>
    {% for trip in trips %}
    <tr>
      <td>{{ trip.start_date }}</td>
      <td>{{ trip.end_date }}</td>
      <td>
        <ul style="margin: 0; padding-left: 1.2em; list-style: none;">
          {% for unit in trip.units.all %}
          <li>
            {{ unit.name }}{% if not forloop.last %} {% endif %}<br>
          </li>
          {% endfor %}
        </ul>
      </td>
      <td>
        <ul style="margin: 0; padding-left: 1.2em; list-style: none;">
          {% for oid in trip.oids.all %}
          <li>
            {{ oid.name }}{% if not forloop.last %} {% endif %}<br>

          </li>
          {% endfor %}
        </ul>
      </td>
<td>
  <ul style="margin: 0; padding-left: 1.2em; list-style: none;">
  
    {% for request in trip.work_requests.all %}
      <li>{{ request.incoming_number }} ({{ request.incoming_date }}){% if not forloop.last %} {% endif %}</li>
    {% endfor %}
  </ul >
</td>

      <td>
         <ul style="margin: 0; padding-left: 1.2em; list-style: none;">
    {% for request in trip.work_requests.all %}
      <li>{{ request.incoming_number }} — {{ request.incoming_date }}</li>
    {% endfor %}
  </ul>
      </td>
      <td>{{ trip.purpose }}</td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="7" class="text-center">Немає записів</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
